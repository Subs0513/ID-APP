<view class="page-wrap"><scroll-view class="page" scroll-y="{{true}}"><view class="cal-header"><view data-event-opts="{{[['tap',[['goPrevMonth',['$event']]]]]}}" class="nav-btn" bindtap="__e">‹</view><view class="header-center"><text class="ym-text">{{year+"年"+month+"月"}}</text><view data-event-opts="{{[['tap',[['goToday',['$event']]]]]}}" class="today-btn" bindtap="__e">回到今天</view></view><view data-event-opts="{{[['tap',[['goNextMonth',['$event']]]]]}}" class="nav-btn" bindtap="__e">›</view></view><view class="week-row"><block wx:for="{{weekNames}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="week-item">{{item}}</view></block></view><view data-event-opts="{{[['touchstart',[['onTouchStart',['$event']]]],['touchend',[['onTouchEnd',['$event']]]]]}}" class="cal-swipe" bindtouchstart="__e" bindtouchend="__e"><view data-event-opts="{{[['transitionend',[['onMonthAnimEnd',['$event']]]]]}}" class="{{['cal-track',(isMonthAnimating)?'is-anim':'',(calNoAnim)?'no-anim':'']}}" style="{{(calTrackStyle)}}" bindtransitionend="__e"><view class="cal-pane"><view class="grid"><block wx:for="{{monthAnimDir==='prev'?nextCells:cells}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="{{['cell '+item.cls]}}" data-date="{{item.dateStr}}" data-event-opts="{{[['tap',[['onTapDate',['$event']]]]]}}" bindtap="__e"><view class="top-mark"><block wx:if="{{item.hasHeart}}"><text class="heart">♡</text></block><block wx:if="{{item.isOvulationDay}}"><view class="ovu-dot"></view></block></view><text class="num">{{item.day}}</text><block wx:if="{{item.isToday}}"><text class="today-tag">今天</text></block></view></block></view></view><view class="cal-pane"><view class="grid"><block wx:for="{{monthAnimDir==='prev'?cells:nextCells}}" wx:for-item="item" wx:for-index="index"><view class="{{['cell '+item.cls]}}" data-date="{{item.dateStr}}" data-event-opts="{{[['tap',[['onTapDate',['$event']]]]]}}" bindtap="__e"><view class="top-mark"><block wx:if="{{item.hasHeart}}"><text class="heart">♡</text></block><block wx:if="{{item.isOvulationDay}}"><view class="ovu-dot"></view></block></view><text class="num">{{item.day}}</text><block wx:if="{{item.isToday}}"><text class="today-tag">今天</text></block></view></block></view></view></view></view><view class="legend"><view class="leg-item"><view class="box b-period"></view><text>月经期</text></view><view class="leg-item"><view class="box b-pred"></view><text>预测经期</text></view><view class="leg-item"><view class="box b-ovu"></view><text>排卵期</text></view><view class="leg-item"><view class="dot"></view><text>排卵日</text></view></view><view data-event-opts="{{[['tap',[['goPeriodAnalysis',['$event']]]]]}}" class="mini-card tappable" bindtap="__e"><view class="mini-left"><image class="mini-icon" src="/static/assets/icons/f_fx.svg" mode="aspectFit"></image><text class="mini-title">经期健康分析</text></view><image class="mini-go" src="/static/assets/icons/f_tz.svg" mode="aspectFit"></image></view><block wx:if="{{!isFutureSelected}}"><view class="panel"><view class="row"><view class="row-left row-left-with-icon"><image class="row-icon" src="/static/assets/icons/f_sd.svg" mode="aspectFit"></image><text class="row-title">月经来了</text></view><switch checked="{{periodSwitchOn}}" color="#ff4d6d" data-event-opts="{{[['change',[['onTogglePeriod',['$event']]]]]}}" bindchange="__e"></switch></view><view data-event-opts="{{[['tap',[['onGoAddPain',['$event']]]]]}}" class="row tappable" bindtap="__e"><view class="row-left row-left-with-icon"><image class="row-icon" src="/static/assets/icons/f_t.svg" mode="aspectFit"></image><text class="row-title">痛经</text></view><view class="row-right"><block wx:if="{{selectedPainText}}"><text class="row-value">{{selectedPainText}}</text></block><image class="plus-icon" src="{{'/static/assets/icons/'+(hasPain?'f_xg.svg':'f_jh.svg')}}" mode="aspectFit"></image></view></view><view data-event-opts="{{[['tap',[['onAddWeight',['$event']]]]]}}" class="row tappable" bindtap="__e"><view class="row-left row-left-with-icon"><image class="row-icon" src="/static/assets/icons/f_tzc.svg" mode="aspectFit"></image><text class="row-title">体重</text></view><view class="row-right"><block wx:if="{{hasWeight}}"><text class="row-value">{{selectedWeightText}}</text></block><block wx:if="{{!hasWeight}}"><image class="plus-icon" src="/static/assets/icons/f_jh.svg" mode="aspectFit"></image></block><block wx:else><image class="plus-icon" src="/static/assets/icons/f_xg.svg" mode="aspectFit"></image></block></view></view><view data-event-opts="{{[['tap',[['onGoAddLove',['$event']]]]]}}" class="row tappable" bindtap="__e"><view class="row-left row-left-with-icon"><image class="row-icon" src="/static/assets/icons/f_sax.svg" mode="aspectFit"></image><text class="row-title">爱爱</text></view><view class="row-right"><block wx:if="{{selectedSexText}}"><text class="row-value">{{selectedSexText}}</text></block><image class="plus-icon" src="{{'/static/assets/icons/'+(hasSex?'f_xg.svg':'f_jh.svg')}}"></image></view></view></view></block><view class="bottom-spacer"></view></scroll-view><block wx:if="{{showWeightPopup}}"><view><view data-event-opts="{{[['tap',[['onWeightCancel',['$event']]]],['touchmove',[['noop',['$event']]]]]}}" class="sheet-mask" bindtap="__e" catchtouchmove="__e"></view><view data-event-opts="{{[['tap',[['noop',['$event']]]],['touchmove',[['noop',['$event']]]]]}}" class="sheet" catchtap="__e" catchtouchmove="__e"><view class="sheet-header"><text data-event-opts="{{[['tap',[['onWeightCancel',['$event']]]]]}}" class="sheet-btn" bindtap="__e">取消</text><text class="sheet-title">体重</text><text data-event-opts="{{[['tap',[['onWeightConfirm',['$event']]]]]}}" class="sheet-btn sheet-btn-primary" bindtap="__e">确定</text></view><view class="sheet-value"><text class="value-num">{{weightDisplay}}</text><text class="value-unit">{{weightUnit==='kg'?'公斤':'斤'}}</text></view><view class="sheet-keypad"><view class="key-row"><view class="key" data-k="1" data-event-opts="{{[['tap',[['onWeightKey',['$event']]]]]}}" bindtap="__e">1</view><view class="key" data-k="2" data-event-opts="{{[['tap',[['onWeightKey',['$event']]]]]}}" bindtap="__e">2</view><view class="key" data-k="3" data-event-opts="{{[['tap',[['onWeightKey',['$event']]]]]}}" bindtap="__e">3</view></view><view class="key-row"><view class="key" data-k="4" data-event-opts="{{[['tap',[['onWeightKey',['$event']]]]]}}" bindtap="__e">4</view><view class="key" data-k="5" data-event-opts="{{[['tap',[['onWeightKey',['$event']]]]]}}" bindtap="__e">5</view><view class="key" data-k="6" data-event-opts="{{[['tap',[['onWeightKey',['$event']]]]]}}" bindtap="__e">6</view></view><view class="key-row"><view class="key" data-k="7" data-event-opts="{{[['tap',[['onWeightKey',['$event']]]]]}}" bindtap="__e">7</view><view class="key" data-k="8" data-event-opts="{{[['tap',[['onWeightKey',['$event']]]]]}}" bindtap="__e">8</view><view class="key" data-k="9" data-event-opts="{{[['tap',[['onWeightKey',['$event']]]]]}}" bindtap="__e">9</view></view><view class="key-row"><view class="key" data-k="." data-event-opts="{{[['tap',[['onWeightKey',['$event']]]]]}}" bindtap="__e">.</view><view class="key" data-k="0" data-event-opts="{{[['tap',[['onWeightKey',['$event']]]]]}}" bindtap="__e">0</view><view data-event-opts="{{[['tap',[['onWeightDel',['$event']]]]]}}" class="key key-del" bindtap="__e"><image class="key-del-icon" src="/static/assets/icons/jpsc.svg" mode="aspectFit"></image></view></view></view></view></view></block></view>