<view class="page"><view class="add-btn" hover-class="btn-active" hover-stay-time="80" data-event-opts="{{[['tap',[['onAddTap',['$event']]]]]}}" bindtap="__e"><image class="icon" src="/static/assets/icons/f_jh.svg" mode="aspectFit"></image><text>添加痛经记录</text></view><block wx:if="{{$root.g0}}"><view class="list"><block wx:for="{{records}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="swipe-item" data-index="{{index}}" data-event-opts="{{[['touchstart',[['onSwipeStart',['$event']]]],['touchmove',[['onSwipeMove',['$event']]]],['touchend',[['onSwipeEnd',['$event']]]],['touchcancel',[['onSwipeEnd',['$event']]]]]}}" bindtouchstart="__e" bindtouchmove="__e" bindtouchend="__e" bindtouchcancel="__e"><view class="swipe-actions" data-index="{{index}}" data-event-opts="{{[['tap',[['onDelete',['$event']]]]]}}" catchtap="__e">删除</view><view data-event-opts="{{[['tap',[['onItemTap',['$0',index],[[['records','',index]]]]]]]}}" class="{{['swipe-content',(item._moving)?'no-anim':'']}}" style="{{('transform: translateX('+(item._x||0)+'rpx);')}}" bindtap="__e"><view class="row1"><view class="left"><view class="pain-badge">痛</view><text class="count">{{"第"+(index+1)+"次"}}</text><text class="time">{{item.time}}</text></view><text class="right-muted">{{item.level||'未选择程度'}}</text></view><block wx:if="{{item.medicine}}"><view class="row2"><text class="meta">{{"用药："+item.medicine}}</text></view></block></view></view></block></view></block><block wx:else><view class="empty">暂无痛经记录</view></block><block wx:if="{{showPopup}}"><view data-event-opts="{{[['tap',[['onCancel',['$event']]]]]}}" class="mask" bindtap="__e"></view></block><block wx:if="{{showPopup}}"><view data-event-opts="{{[['tap',[['',['$event']]]]]}}" class="popup" catchtap="__e"><view class="popup-title">{{editingIndex>=0?'修改痛经记录':'添加痛经记录'}}</view><view class="card"><view class="section-head"><view class="section-left"><image class="section-icon" src="/static/assets/icons/f_sj.svg" mode="aspectFit"></image><text class="section-title">时间</text></view><text class="section-value">{{form.time}}</text></view><view class="time-wheel"><picker-view class="time-picker" value="{{timeWheelValue}}" indicator-style="height: 36px;" data-event-opts="{{[['change',[['onTimeWheelChange',['$event']]]]]}}" bindchange="__e"><picker-view-column><block wx:for="{{hours}}" wx:for-item="h" wx:for-index="i"><view class="time-item">{{h}}</view></block></picker-view-column><picker-view-column><block wx:for="{{minutes}}" wx:for-item="m" wx:for-index="i"><view class="time-item">{{m}}</view></block></picker-view-column></picker-view><text class="time-colon">:</text></view></view><view class="card"><view class="section-head"><view class="section-left"><image class="section-icon" src="/static/assets/icons/f_dp.svg" mode="aspectFit"></image><text class="section-title">程度</text></view><text class="section-value">{{form.level||'未选择'}}</text></view><view class="option-card"><view class="option-wrap"><block wx:for="{{levels}}" wx:for-item="lv" wx:for-index="idx"><view data-event-opts="{{[['tap',[['pickLevel',['$0'],[[['levels','\'lv\'+idx','lv'+idx]]]]]]]}}" class="{{['option-item',(form.level===lv)?'active':'']}}" bindtap="__e"><text class="option-text">{{lv}}</text></view></block></view></view></view><view class="card"><view class="section-head"><view class="section-left"><image class="section-icon" src="/static/assets/icons/f_dp.svg" mode="aspectFit"></image><text class="section-title">用药</text></view><text class="section-value">{{form.medicine||'未选择'}}</text></view><view class="option-card"><view class="option-wrap"><block wx:for="{{medicines}}" wx:for-item="md" wx:for-index="idx"><view data-event-opts="{{[['tap',[['pickMedicine',['$0'],[[['medicines','\'md\'+idx','md'+idx]]]]]]]}}" class="{{['option-item',(form.medicine===md)?'active':'']}}" bindtap="__e"><text class="option-text">{{md}}</text></view></block></view></view></view><view class="popup-actions"><view data-event-opts="{{[['tap',[['onCancel',['$event']]]]]}}" class="btn cancel" bindtap="__e">取消</view><view data-event-opts="{{[['tap',[['onConfirm',['$event']]]]]}}" class="btn ok" bindtap="__e">确定</view></view></view></block></view>