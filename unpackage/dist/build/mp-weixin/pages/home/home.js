(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/home/home"],{"27fe":function(t,e,a){"use strict";a.r(e);var r=a("382b"),n=a.n(r);for(var i in r)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(i);e["default"]=n.a},"382b":function(t,e,a){"use strict";(function(t){var r=a("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(a("34cf")),i=r(a("7ca3"));function s(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function o(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?s(Object(a),!0).forEach((function(e){(0,i.default)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var c=a("5aad"),u=a("f463");function f(t,e){if(!Array.isArray(e)||0===e.length)return t.slice();var a=new Map;t.forEach((function(t){return t&&null!=t.id&&a.set(String(t.id),t)}));var r=new Set,n=[];return e.forEach((function(t){var e=String(t),i=a.get(e);i&&(n.push(i),r.add(e))})),t.forEach((function(t){var e=t&&null!=t.id?String(t.id):"";e&&!r.has(e)&&n.push(t)})),n}var d={components:{PrivacyPopup:function(){a.e("components/privacy-popup/privacy-popup").then(function(){return resolve(a("425a"))}.bind(null,a)).catch(a.oe)}},data:function(){return{statusBarHeight:0,navBarHeight:44,navTotalHeight:0,coupleStartDate:"",daysTogether:0,list:[],showPrivacy:!1,isDragging:!1,dragIndex:-1,dragOffsetY:0,lastY:0,itemHeight:0}},onLoad:function(){var e=t.getSystemInfoSync(),a=e.statusBarHeight||0;this.setData({statusBarHeight:a,navBarHeight:44,navTotalHeight:a+44}),this.refresh()},onShow:function(){this.refresh&&this.refresh();var e=!t.getStorageSync("privacy_agreed_v1");this.setData({showPrivacy:e}),e?t.hideTabBar({animation:!1}):t.showTabBar({animation:!1})},onTabItemTap:function(){this.refresh()},methods:{refresh:function(){var e=c.getCoupleStartDate(),a=u.todayStr(),r=e?u.diffDays(e,a)+1:0,n=c.getList()||[],i=function(e){var a=e.slice(),r=a.filter((function(t){return t&&t.isTop})),n=a.filter((function(t){return!t||!t.isTop})),i=[];try{i=t.getStorageSync("importantDaysOrderIds")||[]}catch(c){i=[]}var s=Array.isArray(i)&&i.length>0;if(s)return f(r,i).concat(f(n,i));var o=function(t){return t.slice().sort((function(t,e){var a=Math.abs(u.daysTo(t.date)),r=Math.abs(u.daysTo(e.date));return a-r}))};return o(r).concat(o(n))}(n),s=i.map((function(t){return o(o({},t),function(t,e){var a=u.daysTo(t);if(0===a)return{badgeFull:"就是今天!"};if(a>0)return{badgeFull:"还有 ".concat(a," 天"),daysAbs:a,daysSign:"后"};var r=Math.abs(a);return{badgeFull:"已经 ".concat(r).concat(e?" + 1":""," 天"),daysAbs:r,daysSign:"前"}}(t.date,t.includeStart))}));this.setData({coupleStartDate:e,daysTogether:r,list:s})},goAdd:function(){t.switchTab({url:"/pages/add/add"})},goDate:function(){t.switchTab({url:"/pages/me/me"})},onTapItem:function(e){if(!this.isDragging){var a=e&&e.currentTarget&&e.currentTarget.dataset?e.currentTarget.dataset.id:"";a&&t.navigateTo({url:"/pages/detail/detail?id="+a})}},onDragStart:function(e){var a=Number(e.currentTarget.dataset.index);if(!Number.isNaN(a)){var r=e.touches&&e.touches[0]?e.touches[0].clientY:0,n=this.itemHeight||74;this.setData({isDragging:!0,dragIndex:a,dragOffsetY:0,lastY:r,itemHeight:n}),t.vibrateShort&&t.vibrateShort()}},onDragMove:function(t){if(this.isDragging&&t.touches&&t.touches[0]){var e=t.touches[0].clientY,a=e-this.lastY,r=this.dragOffsetY+a;this.setData({dragOffsetY:r,lastY:e});var i=this.itemHeight||74,s=Math.round(r/i);if(0!==s){var o=this.dragIndex,c=o+s;if(c<0&&(c=0),c>this.list.length-1&&(c=this.list.length-1),c!==o){var u=this.list.slice(),f=u.splice(o,1),d=(0,n.default)(f,1),g=d[0];u.splice(c,0,g),this.setData({list:u,dragIndex:c,dragOffsetY:0})}}}},onDragEnd:function(){if(this.isDragging){try{var e=(this.list||[]).map((function(t){return t.id}));t.setStorageSync("importantDaysOrderIds",e)}catch(a){}this.setData({isDragging:!1,dragIndex:-1,dragOffsetY:0,lastY:0})}},onAgreePrivacy:function(){try{t.setStorageSync("privacy_agreed_v1",!0)}catch(e){}this.setData({showPrivacy:!1}),t.showTabBar({animation:!1})},onRejectPrivacy:function(){},onOpenDoc:function(e){var a="privacy"===e?"/pages/subabout/privacy/privacy":"/pages/subabout/agreement/agreement";t.navigateTo({url:a})}}};e.default=d}).call(this,a("df3c")["default"])},4623:function(t,e,a){"use strict";a.r(e);var r=a("60ce"),n=a("27fe");for(var i in n)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(i);a("58b5");var s=a("828b"),o=Object(s["a"])(n["default"],r["b"],r["c"],!1,null,"0b1a488e",null,!1,r["a"],void 0);e["default"]=o.exports},"58b5":function(t,e,a){"use strict";var r=a("64d2"),n=a.n(r);n.a},"60ce":function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){return r}));var r={privacyPopup:function(){return a.e("components/privacy-popup/privacy-popup").then(a.bind(null,"425a"))}},n=function(){var t=this.$createElement,e=(this._self._c,!this.list||0===this.list.length);this.$mp.data=Object.assign({},{$root:{g0:e}})},i=[]},"64d2":function(t,e,a){},e63f:function(t,e,a){"use strict";(function(t,e){var r=a("47a9");a("8ba4");r(a("3240"));var n=r(a("4623"));t.__webpack_require_UNI_MP_PLUGIN__=a,e(n.default)}).call(this,a("3223")["default"],a("df3c")["createPage"])}},[["e63f","common/runtime","common/vendor"]]]);