(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/add/add"],{"1a89":function(t,e,i){"use strict";var a=i("552d"),n=i.n(a);n.a},"49e1":function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){}));var a=function(){var t=this.$createElement;this._self._c},n=[]},"4fa1":function(t,e,i){"use strict";(function(t){var a=i("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(i("af34")),o=a(i("7ca3"));function r(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function s(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach((function(e){(0,o.default)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var d=i("5aad"),l=i("f463");function c(){return"id_"+Date.now()+"_"+Math.floor(1e5*Math.random())}var u={components:{YMDWheel:function(){i.e("components/YMD-Wheel/YMD-Wheel").then(function(){return resolve(i("91f6"))}.bind(null,i)).catch(i.oe)},TypeWheel:function(){i.e("components/Type-Wheel/Type-Wheel").then(function(){return resolve(i("d2ba"))}.bind(null,i)).catch(i.oe)}},data:function(){return{isEdit:!1,editId:"",typeOptions:[{value:"anniversary",text:"纪念日"},{value:"birthday",text:"生日"},{value:"other",text:"其他"}],typeIndex:0,form:{title:"",date:"",type:"anniversary",note:"",isTop:!1,includeStart:!1},showDateWheel:!1,dateWheelTemp:"",showTypeWheel:!1,text:""}},onShow:function(){var e=t.getStorageSync("editingId");if(e)return t.removeStorageSync("editingId"),void(this.isEdit&&this.editId===e||this.loadEdit(e));this.isEdit||this.form&&(this.form.title||this.form.note)?this.resetForm():this.form.date||this.resetForm()},onLoad:function(t){var e=t&&t.id?t.id:"";e?this.loadEdit(e):this.resetForm()},methods:{resetForm:function(){this.setData({isEdit:!1,editId:"",typeIndex:0,form:{title:"",date:l.todayStr(),type:"anniversary",note:"",isTop:!1,includeStart:!1},showDateWheel:!1,dateWheelTemp:l.todayStr(),showTypeWheel:!1})},loadEdit:function(e){var i=d.getList(),a=i.find((function(t){return t.id===e}));if(!a)return t.showToast({title:"未找到数据",icon:"none"}),void t.switchTab({url:"/pages/home/home"});var n=this.typeOptions.findIndex((function(t){return t.value===a.type}));this.setData({isEdit:!0,editId:e,typeIndex:n>=0?n:0,form:{title:a.title||"",date:a.date||l.todayStr(),type:a.type||"anniversary",note:a.note||"",isTop:!!a.isTop,includeStart:!!a.includeStart},showDateWheel:!1,dateWheelTemp:a.date||l.todayStr(),showTypeWheel:!1}),t.setNavigationBarTitle({title:"修改重要日子"})},onTitle:function(t){this.setData({form:s(s({},this.form),{},{title:t.detail.value})})},onDate:function(t){this.setData({form:s(s({},this.form),{},{date:t.detail.value})})},openDateWheel:function(){var t=this.form&&this.form.date?this.form.date:l.todayStr();this.setData({showDateWheel:!0,dateWheelTemp:t})},onDateWheelCancel:function(){this.setData({showDateWheel:!1})},onDateWheelConfirm:function(t){this.setData({showDateWheel:!1,dateWheelTemp:t,form:s(s({},this.form),{},{date:t})})},onDateWheelUpdateShow:function(t){this.setData({showDateWheel:!!t})},openTypeWheel:function(){this.setData({showTypeWheel:!0})},onTypeWheelCancel:function(){this.setData({showTypeWheel:!1})},onTypeWheelConfirm:function(t,e){var i=Number(t)||0,a=e&&e.value?e.value:this.typeOptions[i].value;this.setData({showTypeWheel:!1,typeIndex:i,form:s(s({},this.form),{},{type:a})})},onTypeWheelUpdateShow:function(t){this.setData({showTypeWheel:!!t})},onType:function(t){var e=Number(t.detail.value)||0,i=this.typeOptions[e].value;this.setData({typeIndex:e,form:s(s({},this.form),{},{type:i})})},onNote:function(t){this.setData({form:s(s({},this.form),{},{note:t.detail.value})})},onTop:function(t){this.setData({form:s(s({},this.form),{},{isTop:t.detail.value})})},onIncludeStart:function(t){this.setData({form:s(s({},this.form),{},{includeStart:t.detail.value})})},validate:function(){var t=this.form;return t.title&&t.title.trim()?t.date?"":"请选择日期":"请填写标题"},save:function(){var e=this,i=this.validate();if(i)t.showToast({title:i,icon:"none"});else{var a=d.getList(),o=Date.now(),r=this.form;if(this.isEdit){var l=a.map((function(t){return t.id!==e.editId?t:s(s(s({},t),r),{},{updatedAt:o})}));d.setList(l),t.showToast({title:"已保存",icon:"success"});var u=t.getStorageSync("backDetailId");return u?(t.removeStorageSync("backDetailId"),void t.redirectTo({url:"/pages/detail/detail?id="+u})):void t.switchTab({url:"/pages/home/home"})}var h={id:c(),title:r.title.trim(),date:r.date,type:r.type,note:r.note||"",isTop:!!r.isTop,includeStart:!!r.includeStart,createdAt:o,updatedAt:o};d.setList([h].concat((0,n.default)(a))),t.showToast({title:"已添加",icon:"success"}),this.resetForm(),t.switchTab({url:"/pages/home/home"})}}}};e.default=u}).call(this,i("df3c")["default"])},"552d":function(t,e,i){},"5a75":function(t,e,i){"use strict";i.r(e);var a=i("49e1"),n=i("fc9a");for(var o in n)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(o);i("1a89");var r=i("828b"),s=Object(r["a"])(n["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],void 0);e["default"]=s.exports},dc16:function(t,e,i){"use strict";(function(t,e){var a=i("47a9");i("8ba4");a(i("3240"));var n=a(i("5a75"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(n.default)}).call(this,i("3223")["default"],i("df3c")["createPage"])},fc9a:function(t,e,i){"use strict";i.r(e);var a=i("4fa1"),n=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=n.a}},[["dc16","common/runtime","common/vendor"]]]);