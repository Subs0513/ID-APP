<view class="page"><view class="card"><view class="card-title"><image class="card-title-icon" src="/static/assets/icons/f_sax.svg" mode="aspectFit"></image><text class="card-title-text">本周期概览</text></view><view class="grid"><view class="grid-item"><text class="gi-k">本周期次数</text><text class="gi-v">{{metrics.totalThis}}</text></view><view class="grid-item"><text class="gi-k">有记录的天数</text><text class="gi-v">{{metrics.daysWith}}</text></view><view class="grid-item"><text class="gi-k">平均频率</text><text class="gi-v">{{metrics.avgText}}</text></view><view class="grid-item"><text class="gi-k">本周期最长间隔</text><text class="gi-v">{{metrics.maxGapText}}</text></view></view><block wx:if="{{cycleText}}"><view class="p">{{cycleText}}</view></block><block wx:if="{{prevCycleText}}"><view class="p">{{prevCycleText}}</view></block></view><view class="card"><view class="card-title card-title--with-right"><view class="card-title-left"><image class="card-title-icon" src="/static/assets/icons/f_fxts.svg" mode="aspectFit"></image><text class="card-title-text">风险提示</text></view></view><view class="risk-list"><block wx:for="{{riskTips}}" wx:for-item="it" wx:for-index="idx" wx:key="idx"><view class="risk-item"><view class="dot"></view><text class="risk-text">{{it}}</text></view></block></view><block wx:if="{{riskHint}}"><view class="hint">{{riskHint}}</view></block></view><view class="card"><view class="card-title"><image class="card-title-icon" src="/static/assets/icons/f_rq.svg" mode="aspectFit"></image><text class="card-title-text">近30天次数趋势</text></view><view class="chart-sub">{{trendSubText}}</view><view class="chart-wrap"><canvas class="canvas" id="barCanvas" canvas-id="barCanvas" width="{{canvasW}}" height="{{barH}}" data-event-opts="{{[['touchstart',[['onBarTouch',['$event']]]]]}}" bindtouchstart="__e"></canvas><block wx:if="{{barTip.show}}"><view class="bar-tip" style="{{'left:'+(barTip.left+'px')+';'+('top:'+(barTip.top+'px')+';')}}"><text class="bar-tip-date">{{barTip.date}}</text><text class="bar-tip-val">{{barTip.value+" 次"}}</text></view></block></view><view class="p small">提示：只显示每日次数。点击某个柱子可查看该日日期与次数。</view></view><view class="card"><view class="card-title"><image class="card-title-icon" src="/static/assets/icons/f_dp.svg" mode="aspectFit"></image><text class="card-title-text">措施分布（本周期）</text></view><view class="chart-sub">{{methodSubText}}</view><canvas class="canvas" id="pieCanvas" canvas-id="pieCanvas" width="{{canvasW}}" height="{{pieH}}"></canvas><view class="legend"><block wx:for="{{methodLegend}}" wx:for-item="l" wx:for-index="idx" wx:key="idx"><view class="legend-item"><view class="legend-color" style="{{'background-color:'+(l.color)+';'}}"></view><text class="legend-text">{{l.label}}</text><text class="legend-val">{{l.value}}</text></view></block></view></view><view class="card"><view class="card-title"><image class="card-title-icon" src="/static/assets/icons/f_sj.svg" mode="aspectFit"></image><text class="card-title-text">最近记录（5条）</text></view><block wx:if="{{$root.g0}}"><view class="recent"><block wx:for="{{recentList}}" wx:for-item="r" wx:for-index="idx" wx:key="idx"><view class="recent-item"><view class="recent-left"><text class="recent-date">{{r.dateLabel}}</text><text class="recent-time">{{r.time}}</text></view><text class="recent-method">{{r.method}}</text></view></block></view></block><block wx:else><view class="empty"><text class="empty-text">还没有爱爱记录哦～先去记录一条吧</text><view data-event-opts="{{[['tap',[['goAdd',['$event']]]]]}}" class="btn" bindtap="__e">去记录</view></view></block></view></view>